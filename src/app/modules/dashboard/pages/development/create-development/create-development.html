<div class="min-h-screen">
  <div class="max-w-6xl mx-auto">
    @if (isLoaded()) {
    <div class="h-screen w-full flex items-center justify-center">
      <app-loader />
    </div>
    } @else {

    <!-- Error messages display -->
    @if (errorMessages().length > 0) {
    <div
      class="mb-6 p-4 glass border-l-4 border-red-500 rounded-lg backdrop-blur-sm"
    >
      <div class="flex items-center">
        <div class="flex-shrink-0 text-red-500">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path
              fill-rule="evenodd"
              d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zm-1 9a1 1 0 01-1-1v-4a1 1 0 112 0v4a1 1 0 01-1 1z"
              clip-rule="evenodd"
            ></path>
          </svg>
        </div>
        <div class="ml-3">
          <h3 class="text-sm font-medium text-red-400">
            There were errors with your submission
          </h3>
          <div class="mt-2 text-sm text-red-300">
            <ul class="list-disc pl-5 space-y-1">
              @for (error of errorMessages(); track $index) {
              <li>{{ error }}</li>
              }
            </ul>
          </div>
        </div>
      </div>
    </div>
    }

    <!-- Header Section -->
    <section class="sm:mb-12">
      <div
        class="sm:flex-col md:flex-row md:justify-between md:items-center gap-4 mb-8 "
      >
        <div class="hidden sm:block mb-4">
          <h1 class="text-4xl font-bold text-white text-glow-primary">
            Development Configuration
          </h1>
          <p class="text-gray-400 mt-2">
            Configure your application development settings
          </p>
        </div>

        <!-- Back Button (only show when not on mode selection) -->
        @if (currentStep() !== 'mode-selection') {
        <button
          class="outer-button w-[55px] sm:w-auto flex items-center gap-2"
          (click)="goBack()"
        >
          <span class="pi pi-arrow-left"></span>
          <span class="hidden sm:block">Back</span>
        </button>
        }
      </div>
    </section>

    <!-- Step 1: Mode Selection -->
    @if (currentStep() === 'mode-selection') {
    <section class="md:glass-card md:p-8 sm:p-4 mb-8 backdrop-blur-sm">
      <div class="text-center mb-8">
        <h2 class="text-2xl font-bold text-white mb-4">
          Choose Your Development Mode
        </h2>
        <p class="text-gray-400">
          Select how you want to configure your application
        </p>
      </div>

      <div class="grid grid-cols-2 gap-3 md:gap-6">
        <!-- Quick Generation Mode -->
        <div
          class="glass-card p-3 md:p-4 cursor-pointer transition-all duration-300 hover:glow-primary"
          (click)="selectMode('quick')"
        >
          <div class="text-center">
            <div
              class="w-12 h-12 md:w-16 md:h-16 mx-auto mb-2 md:mb-4 rounded-full bg-gradient-to-r from-primary to-primary/60 flex items-center justify-center"
            >
              <i class="pi pi-bolt text-lg md:text-2xl text-white"></i>
            </div>
            <h3 class="text-sm md:text-xl font-bold text-white mb-2 md:mb-3">
              Quick
            </h3>
            <p
              class="text-xs md:text-sm text-gray-400 mb-2 md:mb-4 hidden md:block"
            >
              Pre-configured setup with React, Express.js, and Supabase
            </p>
            <div class="text-xs md:text-sm text-gray-500 space-y-1">
              <div class="flex items-center justify-center gap-1 md:gap-2">
                <i class="pi pi-check text-green-400 text-xs"></i>
                <span>React</span>
              </div>
              <div
                class="hidden md:flex items-center justify-center gap-1 md:gap-2"
              >
                <i class="pi pi-check text-green-400 text-xs"></i>
                <span>Express.js</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Advanced Mode -->
        <div
          class="glass-card p-3 md:p-6 cursor-pointer transition-all duration-300 hover:glow-secondary"
          (click)="selectMode('advanced')"
        >
          <div class="text-center">
            <div
              class="w-12 h-12 md:w-16 md:h-16 mx-auto mb-2 md:mb-4 rounded-full bg-gradient-to-r from-secondary to-secondary-glow/60 flex items-center justify-center"
            >
              <i class="pi pi-cog text-lg md:text-2xl text-white"></i>
            </div>
            <h3 class="text-sm md:text-xl font-bold text-white mb-2 md:mb-3">
              Advanced
            </h3>
            <p
              class="text-xs md:text-sm text-gray-400 mb-2 md:mb-4 hidden md:block"
            >
              Full control over all technology choices and settings
            </p>
            <div class="text-xs md:text-sm text-gray-500 space-y-1">
              <div class="flex items-center justify-center gap-1 md:gap-2">
                <i class="pi pi-check text-blue-400 text-xs"></i>
                <span>Custom</span>
              </div>
              <div
                class="hidden md:flex items-center justify-center gap-1 md:gap-2"
              >
                <i class="pi pi-check text-blue-400 text-xs"></i>
                <span>Full Control</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    }

    <!-- Step 2: Generation Type Selection (only for quick mode) -->
    @if (currentStep() === 'generation-type') {
    <section class="sm:glass-card sm:p-8 mb-8 backdrop-blur-sm">
      <div class="text-center mb-8">
        <h2 class="text-2xl font-bold text-white mb-4">
          What do you want to generate?
        </h2>
        <p class="text-gray-400">
          Choose the type of application you want to create
        </p>
      </div>

      <div class="grid grid-cols-2 gap-3 md:gap-6 max-w-4xl mx-auto">
        <!-- Landing Page Only -->
        <div
          class="glass-card p-3 md:p-6 cursor-pointer transition-all duration-300 hover:glow-primary"
          (click)="selectGenerationType('landing')"
        >
          <div class="text-center">
            <div
              class="w-12 h-12 md:w-16 md:h-16 mx-auto mb-2 md:mb-4 rounded-full bg-gradient-to-r from-primary to-primary-glow/70 flex items-center justify-center"
            >
              <i class="pi pi-desktop text-lg md:text-2xl text-white"></i>
            </div>
            <h3 class="text-sm md:text-xl font-bold text-white mb-2 md:mb-3">
              Landing
            </h3>
            <p
              class="text-xs md:text-sm text-gray-400 mb-2 md:mb-4 hidden md:block"
            >
              A beautiful standalone marketing website to showcase your product
              or service
            </p>
            <div class="flex items-center justify-center">
              <span
                class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-primary/20 text-primary"
              >
                Marketing
              </span>
            </div>
          </div>
        </div>

        <!-- Web Application Only -->
        <div
          class="glass-card p-3 md:p-6 cursor-pointer transition-all duration-300 hover:glow-secondary"
          (click)="selectGenerationType('app')"
        >
          <div class="text-center">
            <div
              class="w-12 h-12 md:w-16 md:h-16 mx-auto mb-2 md:mb-4 rounded-full bg-gradient-to-r from-secondary to-secondary-glow/70 flex items-center justify-center"
            >
              <i class="pi pi-mobile text-lg md:text-2xl text-white"></i>
            </div>
            <h3 class="text-sm md:text-xl font-bold text-white mb-2 md:mb-3">
              Web App
            </h3>
            <p
              class="text-xs md:text-sm text-gray-400 mb-2 md:mb-4 hidden md:block"
            >
              A full-featured web application with user authentication and
              database
            </p>
            <div class="flex items-center justify-center">
              <span
                class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-secondary/20 text-secondary"
              >
                App
              </span>
            </div>
          </div>
        </div>

        <!-- Landing Page + Web App (Integrated) -->
        <div
          class="glass-card p-3 md:p-6 cursor-pointer transition-all duration-300 hover:glow-accent"
          (click)="selectGenerationType('integrated')"
        >
          <div class="text-center">
            <div
              class="w-12 h-12 md:w-16 md:h-16 mx-auto mb-2 md:mb-4 rounded-full bg-gradient-to-r from-accent to-accent-glow/70 flex items-center justify-center"
            >
              <i class="pi pi-link text-lg md:text-2xl text-white"></i>
            </div>
            <h3 class="text-sm md:text-xl font-bold text-white mb-2 md:mb-3">
              Integrated
            </h3>
            <p
              class="text-xs md:text-sm text-gray-400 mb-2 md:mb-4 hidden md:block"
            >
              Landing page integrated within the web application for seamless
              user experience
            </p>
            <div class="flex items-center justify-center">
              <span
                class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-accent/20 text-accent"
              >
                Unified
              </span>
            </div>
          </div>
        </div>

        <!-- Landing Page + Web App (Separate) -->
        <div
          class="glass-card p-3 md:p-6 cursor-pointer transition-all duration-300 hover:glow-primary"
          (click)="selectGenerationType('both')"
        >
          <div class="text-center">
            <div
              class="w-12 h-12 md:w-16 md:h-16 mx-auto mb-2 md:mb-4 rounded-full bg-gradient-to-r from-primary to-secondary flex items-center justify-center"
            >
              <i class="pi pi-th-large text-lg md:text-2xl text-white"></i>
            </div>
            <h3 class="text-sm md:text-xl font-bold text-white mb-2 md:mb-3">
              Complete
            </h3>
            <p
              class="text-xs md:text-sm text-gray-400 mb-2 md:mb-4 hidden md:block"
            >
              Separate landing page + web application for maximum flexibility
              and scalability
            </p>
            <div class="flex items-center justify-center">
              <span
                class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-gradient-to-r from-primary/20 to-secondary/20 text-white"
              >
                Full Stack
              </span>
            </div>
          </div>
        </div>
      </div>
    </section>
    }

    <!-- Step 3: Configuration (for both quick and advanced modes) -->
    @if (currentStep() === 'configuration') {

    <!-- Quick Mode Configuration Summary -->
    @if (selectedMode() === 'quick') {
    <section class="glass-card p-8 mb-8 backdrop-blur-sm">
      <div class="text-center mb-8">
        <h2 class="text-2xl font-bold text-white mb-4">
          Configuration Summary
        </h2>
        <p class="text-gray-400">Review your quick generation settings</p>
      </div>

      <div class="grid md:grid-cols-2 gap-6 mb-8">
        <div class="glass-card p-4">
          <h3 class="text-lg font-semibold text-white mb-3">Generation Type</h3>
          <div class="flex items-center gap-2">
            <i class="pi pi-check text-green-400"></i>
            <span class="text-gray-300 capitalize"
              >{{ selectedGenerationType() }}</span
            >
          </div>
        </div>

        <div class="glass-card p-4">
          <h3 class="text-lg font-semibold text-white mb-3">
            Technology Stack
          </h3>
          <div class="space-y-2 text-sm">
            <div class="flex items-center gap-2">
              <i class="pi pi-check text-green-400"></i>
              <span class="text-gray-300">React Frontend</span>
            </div>
            <div class="flex items-center gap-2">
              <i class="pi pi-check text-green-400"></i>
              <span class="text-gray-300">Express.js Backend</span>
            </div>
            <div class="flex items-center gap-2">
              <i class="pi pi-check text-green-400"></i>
              <span class="text-gray-300">Supabase Database</span>
            </div>
          </div>
        </div>
      </div>

      <div class="text-center">
        <button
          class="inner-button flex items-center gap-2 mx-auto"
          (click)="onSaveConfiguration()"
        >
          <span>Generate Application</span>
          <span class="pi pi-arrow-right"></span>
        </button>
      </div>
    </section>
    }

    <!-- Advanced Mode Configuration -->
    @if (selectedMode() === 'advanced') {
    <section class="sm:glass-card sm:p-6 mb-8 backdrop-blur-sm">
      <div class="text-center mb-8">
        <h2 class="text-2xl font-bold text-white mb-4">
          Advanced Configuration
        </h2>
        <p class="text-gray-400">Configure all aspects of your application</p>
      </div>

      <!-- Tab Navigation -->
      <div class="mb-8">
        <div
          class="glass p-2 rounded-2xl grid grid-cols-2 md:grid-cols-3 gap-1 backdrop-blur-sm"
        >
          @for (tab of tabs; track tab) {
          <button
            class="py-4 text-white text-base font-medium flex items-center justify-center outer-button gap-3 transition-all duration-300 rounded-xl"
            [class.inner-button]="selectedTab() === tab"
            [class.glass]="selectedTab() !== tab"
            (click)="selectTab(tab)"
          >
            <span
              class="pi"
              [class.pi-desktop]="tab === 'frontend'"
              [class.pi-server]="tab === 'backend'"
              [class.pi-database]="tab === 'database'"
              [class.pi-database]="tab === 'deployment'"
              
              
            ></span>
            <span>{{ tab | titlecase }}</span>
          </button>
          }
        </div>
      </div>

      <!-- Tab Content -->
      @switch (selectedTab()) { @case ('frontend') {
      <app-frontend-config
        [frontendForm]="frontendForm"
        [versionOptions]="{}"
        [showAdvancedOptions]="showAdvancedOptions()"
        [selectedStylingPreferences]="selectedStylingPreferences()"
      >
      </app-frontend-config>
      } @case ('backend') {
      <app-backend-config
        [backendForm]="backendForm"
        [versionOptions]="{}"
        [showAdvancedOptions]="showAdvancedOptions()"
      >
      </app-backend-config>
      } @case ('database') {
      <app-database-config [databaseForm]="databaseForm"></app-database-config>
      } @case ('deployment') {
      <app-deployment-config ></app-deployment-config>
      } }

      <!-- Action Buttons -->
      <div class="flex justify-end mt-8">
        <button
          class="inner-button flex items-center gap-2"
          (click)="onSaveConfiguration()"
        >
          <span>Save configs</span>
          <span class="pi pi-arrow-right"></span>
        </button>
      </div>
    </section>
    } } }
  </div>
</div>
