<div class="h-full w-full relative overflow-x-hidden">
  <!-- Progress indicator with animated glow effect-->
  <div class="fixed mt-[60px] top-0 left-0 w-full h-1 bg-gray-200 z-50">
    <div
      class="h-full bg-gradient-to-r from-primary via-primary/80 to-secondary/80 transition-all duration-500 ease-out progress-glow"
      [style.width]="(currentStepIndex() + 1) * 100 / steps.length + '%'"
    ></div>
  </div>

  @if (isLoaded()) {
  <div class="h-screen w-full flex items-center justify-center">
    <app-loader />
  </div>
  } @else {

  <!-- Step navigation indicators with tooltips and enhanced interaction -->
  <!-- Navigation Buttons (Fixed position) -->
  <div
    class="fixed bottom-8 left-1/2 transform -translate-x-1/2 z-50 flex flex-wrap justify-center gap-3 md:gap-4 items-center max-w-[95vw] px-2"
  >
    <!-- Previous Button -->
    <button
      *ngIf="currentStepIndex() > 0"
      (click)="goToPreviousStep()"
      class="group flex items-center bg-black/70 hover:bg-black/90 text-white py-2 md:py-3 px-4 md:px-5 rounded-full transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl backdrop-blur-md"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-4 w-4 md:h-5 md:w-5 mr-2 transition-transform duration-300 group-hover:-translate-x-1"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M15 19l-7-7 7-7"
        />
      </svg>
      <span class="text-sm md:text-base">Previous</span>
    </button>

    <!-- Step Counter Badge -->
    <div
      class="hidden md:flex items-center justify-center bg-gray-800/70 text-white text-xs rounded-full h-8 px-3 mx-1 backdrop-blur-md"
    >
      Step {{currentStepIndex() + 1}} of {{steps.length}}
    </div>

    <!-- Next Button -->
    <button
      *ngIf="currentStepIndex() < steps.length - 1"
      (click)="goToNextStep()"
      class="group flex items-center bg-gradient-to-r from-primary to-secondary hover:from-primary/80 hover:to-secondary/80 text-white py-2 md:py-3 px-5 md:px-6 rounded-full transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl"
    >
      <span class="text-sm md:text-base">Next</span>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-4 w-4 md:h-5 md:w-5 ml-2 transition-transform duration-300 group-hover:translate-x-1"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M9 5l7 7-7 7"
        />
      </svg>
    </button>

    <!-- Finish Button -->
    <button
      *ngIf="currentStepIndex() === steps.length - 1"
      (click)="finalizeProjectCreation()"
      class="group flex items-center bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600 text-white py-2 md:py-3 px-5 md:px-6 rounded-full transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl"
    >
      <span class="text-sm md:text-base">Finish</span>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-4 w-4 md:h-5 md:w-5 ml-2 transition-transform duration-300 group-hover:translate-x-1"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M5 13l4 4L19 7"
        />
      </svg>
    </button>
  </div>

  <!-- Step Indicator Dots -->
  <div
    class="fixed top-[80px] right-5 z-40 bg-gray-800/80 backdrop-blur-sm rounded-full py-2 px-3 shadow-lg"
  >
    <div class="flex gap-3 items-center">
      @for (step of steps; track step.id; let i = $index) {
      <div class="relative group">
        <button
          (click)="navigateToStep(i)"
          class="w-3 h-3 rounded-full transition-all duration-300 transform hover:scale-150"
          [class.bg-gray-600]="isStepActive(i)"
          [class.bg-gray-500]="!isStepActive(i)"
          [class.scale-125]="isStepActive(i)"
          [class.shadow-md]="isStepActive(i)"
          [attr.aria-label]="'Navigate to ' + step.title"
        >
          @if (isStepActive(i)) {
          <span
            class="animate-ping absolute h-full w-full rounded-full opacity-30 bg-white"
          ></span>
          }
        </button>
        <!-- Tooltip -->
        <span
          class="absolute -bottom-8 left-1/2 -translate-x-1/2 whitespace-nowrap bg-gray-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300"
        >
          {{step.title}}
        </span>
      </div>
      }
    </div>
  </div>

  @if (isStepActive(0)) {
  <section #projectDescription class="animate-fadeIn">
    <app-project-description
      (nextStep)="goToNextStep()"
      [project]="project"
    ></app-project-description>
  </section>
  } @if (isStepActive(1)) {
  <section #projectDetails class="animate-slideInRight">
    <app-project-details
      (nextStep)="goToNextStep()"
      (previousStep)="goToPreviousStep()"
      (constraintsChange)="onConstraintsChange()"
      [project]="project"
      [groupedProjectTypes]="groupedProjectTypes"
      [groupedTeamSizes]="groupedTeamSizes"
      [groupedScopes]="groupedScopes"
      [groupedBudgets]="groupedBudgets"
      [groupedTargets]="groupedTargets"
      [groupedConstraints]="groupedConstraints"
      [selectedConstraints]="selectedConstraints()"
    ></app-project-details>
  </section>
  } @if (isStepActive(2)) {
  <section #logoSelection class="animate-slideInRight">
    <app-logo-selection
      (logoSelected)="selectLogo($event)"
      (nextStep)="goToNextStep()"
      (previousStep)="goToPreviousStep()"
      [logos]="logos"
    ></app-logo-selection>
  </section>
  } @if (isStepActive(3)) {
  <section #colorSelection class="animate-slideInRight">
    <app-color-selection
      (colorSelected)="selectColor($event)"
      (nextStep)="goToNextStep()"
      (previousStep)="goToPreviousStep()"
      [colorPalettes]="colorPalettes"
      [selectedColor]="selectedColor"
    ></app-color-selection>
  </section>
  } @if (isStepActive(4)) {
  <section #typographySelection class="animate-slideInRight">
    <app-typography-selection
      (typographySelected)="selectTypography($event)"
      (nextStep)="goToNextStep()"
      (previousStep)="goToPreviousStep()"
      [typographyOptions]="typographyOptions"
      [selectedTypography]="selectedTypography"
    ></app-typography-selection>
  </section>
  } @if (isStepActive(5)) {
  <section #summarySelection class="animate-slideInRight">
    <app-project-summary
      (createProject)="finalizeProjectCreation()"
      (previousStep)="goToPreviousStep()"
      [project]="project"
      [selectedLogo]="selectedLogo"
      [selectedColor]="selectedColor"
      [selectedTypography]="selectedTypography"
      [logos]="logos"
      [colorPalettes]="colorPalettes"
      [typographyOptions]="typographyOptions"
      [privacyPolicyAccepted]="privacyPolicyAccepted()"
      [marketingConsentAccepted]="marketingConsentAccepted()"
    ></app-project-summary>
  </section>
  } }
</div>
