<div class="h-full w-full">
  @if (isLoaded()) {
  <div class="h-screen w-full flex items-center justify-center">
    <app-loader />
  </div>
  } @else { @if (isFirstStep()) {
  <section
    class="md:h-screen flex flex-col items-center justify-center w-full"
    #projectDescription
  >
    <h1
      class="text-2xl w-full md:text-5xl text-center font-bold text-gray-100 mb-4 pb-2"
    >
      DESCRIBE YOUR PROJECT
    </h1>
    <div
      class="bg-gray-700 rounded-2xl px-4 py-2 w-full sm:min-w-[500px] sm:max-w-[750px]"
    >
      <!-- Input area -->
      <textarea
        id="projectDescription"
        [(ngModel)]="project.description"
        rows="4"
        class="bg-transparent text-gray-300 w-full outline-none placeholder-gray-500 text-lg resize-none overflow-y-auto max-h-[400px]"
        placeholder="Message Idem"
        (input)="autoResize($event)"
      ></textarea>

      <!-- Bottom buttons -->
      <div class="flex justify-between items-center mt-2">
        <!-- Left buttons -->
        <div class="flex space-x-2">
          <button
            class="flex items-center bg-gray-600 text-gray-300 px-3 py-1 rounded-full hover:bg-gray-500"
          >
            <i class="pi pi-brain mr-2"></i> Reformuler
          </button>
          <button
            class="flex items-center bg-blue-600 text-white px-3 py-1 rounded-full hover:bg-blue-500"
          >
            <i class="pi pi-globe mr-2"></i> Corriger
          </button>
        </div>

        <!-- Right icons -->
        <div class="flex items-center space-x-3">
          <i class="pi pi-paperclip text-gray-400 text-xl cursor-pointer"></i>
          <button
            class="flex items-center justify-center w-8 h-8 bg-gray-500 text-gray-300 rounded-full hover:bg-gray-400"
            (click)="goToSecondStep()"
          >
            <i class="pi pi-arrow-up"></i>
          </button>
        </div>
      </div>
    </div>
  </section>
  } @if (isSecondStep()) {
  <section
    class="md:h-screen flex flex-col items-center justify-center text-gray-100 w-full"
    #projectDetails
  >
    <h1
      class="text-2xl md:text-5xl text-center font-bold text-gray-100 mb-4 pb-2 w-[60%]"
    >
      Before continuing, we need more information about your project
    </h1>
    <div class="max-w-3xl mx-auto p-6 w-full">
      <h2 class="text-xl font-semibold text-gray-100 mb-4">Project Details</h2>

      <div class="mb-4 w-full">
        <p-floatlabel variant="in">
          <input
            pInputText
            id="in_label"
            [(ngModel)]="project.name"
            autocomplete="off"
            class="w-full input"
          />
          <label for="in_label">Project Name</label>
        </p-floatlabel>
      </div>

      <div class="mb-4">
        <label for="projectType" class="block text-sm font-medium">
          Project Type
        </label>
        <div class="card flex justify-start w-full">
          <p-select
            [options]="groupedProjectTypes"
            [(ngModel)]="project.type"
            placeholder="Select a type"
            [editable]="false"
            optionLabel="name"
            styleClass=" w-full input"
          />
        </div>
      </div>

      <h2 class="text-xl font-semibold text-gray-100 mb-4">Planning Options</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="mb-4">
          <label for="teamSize" class="block text-sm font-medium">
            Team Size
          </label>
          <div class="card flex justify-start w-full">
            <p-select
              [options]="groupedTeamSizes"
              [(ngModel)]="project.teamSize"
              placeholder="Select team size"
              [editable]="true"
              optionLabel="name"
              styleClass=" w-full input"
            />
          </div>
        </div>

        <div class="mb-4">
          <label for="projectScope" class="block text-sm font-medium">
            Project Scope
          </label>

          <div class="card flex justify-start w-full">
            <p-select
              [options]="groupedScopes"
              [(ngModel)]="project.scope"
              placeholder="Select a scope"
              [editable]="true"
              optionLabel="name"
              styleClass=" w-full input"
            />
          </div>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="mb-4">
          <label for="projectBudget" class="block text-sm font-medium">
            Project Budget
          </label>
          <div class="card flex justify-start w-full">
            <p-select
              [options]="groupedBudgets"
              [(ngModel)]="project.budgetIntervals"
              placeholder="Select a budget"
              [editable]="true"
              optionLabel="name"
              styleClass=" w-full input"
            />
          </div>
        </div>
        <div class="mb-4">
          <label for="projectTargets" class="block text-sm font-medium">
            Main Project Target
          </label>
          <div class="relative mt-1 rounded-md shadow-sm">
            <div class="card flex justify-start w-full">
              <p-select
                [options]="groupedTargets"
                [(ngModel)]="project.targets"
                placeholder="Select a target"
                [editable]="true"
                optionLabel="name"
                styleClass=" w-full input"
              />
            </div>
          </div>
        </div>
        <div>
          <label class="block text-sm font-medium">
            Technical Constraints
          </label>
          <div class="flex justify-start w-full">
            <div class="card flex justify-center w-full">
              <p-multiselect
                [options]="groupedConstraints"
                [group]="true"
                [(ngModel)]="selectedConstraints"
                placeholder="Select constraints"
                (onChange)="onConstraintsChange()"
                scrollHeight="350px"
                display="chip"
                styleClass=" w-full input"
              >
                <ng-template let-group #group>
                  <div class="flex items-center">
                    <img
                      src="https://primefaces.org/cdn/primeng/images/demo/flag/flag_placeholder.png"
                      [class]="'mr-2 flag flag-' + group.value"
                      style="width: 20px"
                    />
                    <span class="font-bold">{{ group.label }}</span>
                  </div>
                </ng-template>
              </p-multiselect>
            </div>
          </div>
        </div>
      </div>
      <div class="flex w-full justify-end gap-4">
        <button (click)="goToFirstStep()" class="outer-button">Preview</button>
        <button class="btn btn-primary" (click)="showLogoSelectionStep()">
          Analyze Project
        </button>
      </div>
    </div>
  </section>
  }

  <!-- Color Selection Section -->
  @if (isColorStep()) {
  <section
    class="md:h-screen flex flex-col items-center justify-center w-full"
    #colorSelection
  >
    <h1
      class="text-2xl md:text-5xl text-center font-bold text-gray-100 mb-4 pb-2 w-[60%]"
    >
      Select a color palette for your brand
    </h1>

    <div class="card flex justify-center">
      <div class="max-w-4xl mx-auto p-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          @for (color of colorPalettes; track color.id) {
          <div
            class="p-6 border border-gray-700 rounded-xl hover:shadow-lg hover:shadow-primary/30 hover:bg-gray-900/50 transition-all cursor-pointer group relative overflow-hidden"
            [style.boxShadow]="selectedColor === color.id ? '0 0 15px ' + color.colors.primary : 'none'"
            [class.border-2]="selectedColor === color.id"
            [style.borderColor]="selectedColor === color.id ? color.colors.primary : ''"
            (click)="selectColor(color.id)"
          >
            <div
              class="absolute inset-0 bg-gradient-to-br opacity-0 group-hover:opacity-10 transition-opacity duration-300"
              [style.backgroundImage]="'linear-gradient(to bottom right, ' + color.colors.primary + ', ' + color.colors.accent + ')'"
              [class.opacity-20]="selectedColor === color.id"
            ></div>

            <h3 class="text-white text-lg font-medium mb-3 z-10">
              {{ color.name }}
            </h3>

            <div class="flex space-x-2 mb-4">
              <div
                class="w-8 h-8 rounded-full"
                [style.backgroundColor]="color.colors.primary"
              ></div>
              <div
                class="w-8 h-8 rounded-full"
                [style.backgroundColor]="color.colors.secondary"
              ></div>
              <div
                class="w-8 h-8 rounded-full"
                [style.backgroundColor]="color.colors.accent"
              ></div>
              <div
                class="w-8 h-8 rounded-full border border-gray-500"
                [style.backgroundColor]="color.colors.background"
              ></div>
            </div>

            <div
              class="mt-2 p-3 rounded"
              [style.backgroundColor]="color.colors.background"
            >
              <p [style.color]="color.colors.text" class="font-medium">
                Sample Text
              </p>
              <div class="flex mt-2">
                <button
                  class="px-3 py-1 rounded mr-2 text-sm"
                  [style.backgroundColor]="color.colors.primary"
                  [style.color]="'white'"
                >
                  Primary
                </button>
                <button
                  class="px-3 py-1 rounded text-sm"
                  [style.backgroundColor]="color.colors.accent"
                  [style.color]="'white'"
                >
                  Accent
                </button>
              </div>
            </div>
          </div>
          }
        </div>
      </div>
    </div>
  </section>
  }

  <!-- Typography Selection Section -->
  @if (isTypographyStep()) {
  <section
    class="md:h-screen flex flex-col items-center justify-center w-full"
    #typographySelection
  >
    <h1
      class="text-2xl md:text-5xl text-center font-bold text-gray-100 mb-4 pb-2 w-[60%]"
    >
      Select typography that matches your brand
    </h1>

    <div class="card flex justify-center">
      <div class="max-w-4xl mx-auto p-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          @for (typo of typographyOptions; track typo.id) {
          <div
            class="p-6 border border-gray-700 rounded-xl hover:shadow-lg hover:shadow-primary/30 hover:bg-gray-900/50 transition-all cursor-pointer flex flex-col group relative overflow-hidden"
            [class.border-primary]="selectedTypography === typo.id"
            [class.bg-gray-900]="selectedTypography === typo.id"
            (click)="selectTypography(typo.id)"
          >
            <div
              class="absolute inset-0 bg-gradient-to-br from-primary/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"
              [class.opacity-50]="selectedTypography === typo.id"
            ></div>

            <h3 class="text-white text-lg font-medium mb-3 z-10">
              {{ typo.name }}
            </h3>

            <div class="bg-gray-800/50 p-4 rounded-lg mb-3">
              <p
                class="text-xl font-bold mb-2"
                [style.fontFamily]="typo.primaryFont"
              >
                Primary: {{ typo.primaryFont }}
              </p>
              <p class="text-base" [style.fontFamily]="typo.secondaryFont">
                Secondary: {{ typo.secondaryFont }}
              </p>
            </div>

            <div class="bg-white/10 p-4 rounded-lg">
              <h4
                class="text-xl font-bold mb-2"
                [style.fontFamily]="typo.primaryFont"
              >
                Headline Text
              </h4>
              <p class="text-sm" [style.fontFamily]="typo.secondaryFont">
                This is a sample paragraph showing how your content would look
                with this typography selection. Good typography improves
                readability and user experience.
              </p>
            </div>

            <div
              class="w-0 group-hover:w-full h-1 bg-primary mt-4 transition-all duration-300"
              [class.w-full]="selectedTypography === typo.id"
            ></div>
          </div>
          }
        </div>
      </div>
    </div>
  </section>
  }

  <!-- Logo Selection Section -->
  @if (isLogoStep()) {
  <section
    class="md:h-screen flex flex-col items-center justify-center w-full"
    #logoSelection
  >
    <h1
      class="text-2xl md:text-5xl text-center font-bold text-gray-100 mb-4 pb-2 w-[60%]"
    >
      Choose a stunning logo for your project
    </h1>

    <div class="card flex justify-center">
      <div class="max-w-4xl mx-auto p-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          @for (logo of logos; track logo.id) {
          <div
            class="p-6 border border-gray-700 rounded-xl hover:shadow-lg hover:shadow-primary/30 hover:bg-gray-900/50 transition-all cursor-pointer flex flex-col items-center group relative overflow-hidden"
            [class.border-primary]="selectedLogo === logo.id"
            [class.bg-gray-900]="selectedLogo === logo.id"
            (click)="selectLogo(logo.id)"
          >
            <div
              class="absolute inset-0 bg-gradient-to-br from-primary/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"
              [class.opacity-50]="selectedLogo === logo.id"
            ></div>
            <div
              class="w-full h-48 mb-3 z-10 transition-transform duration-300 group-hover:scale-105"
              [class.scale-105]="selectedLogo === logo.id"
              [innerHTML]="logo.svg | safeHtml"
            ></div>
            <h3 class="text-white text-lg font-medium z-10">{{ logo.name }}</h3>
            <div
              class="w-0 group-hover:w-full h-1 bg-primary mt-2 transition-all duration-300"
              [class.w-full]="selectedLogo === logo.id"
            ></div>
          </div>
          }
        </div>
      </div>
    </div>
  </section>
  } @if (isSummaryStep()) {
  <section
    class="md:min-h-screen flex flex-col items-center justify-center w-full pb-10"
    #summarySelection
  >
    <h1
      class="text-2xl md:text-5xl text-center font-bold text-gray-100 mb-8 pb-2 w-[60%]"
    >
      Check all your choices and finalize your project
    </h1>
    <div class="card flex justify-center w-full">
      <div class="max-w-4xl mx-auto p-6 w-full">
        <!-- Project Information Summary -->
        <div class="bg-gray-800/50 rounded-xl p-6 mb-8">
          <h2
            class="text-2xl font-bold text-gray-100 mb-4 border-b border-gray-700 pb-2"
          >
            Project Information
          </h2>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-4">
            <div>
              <h3 class="text-lg font-semibold text-gray-300 mb-2">
                Basic Details
              </h3>
              <div class="space-y-2 text-gray-200">
                <p>
                  <strong>Name:</strong> {{ project.name || 'Not specified' }}
                </p>
                <p>
                  <strong>Type:</strong> {{ project.type || 'Not specified' }}
                </p>
                <p>
                  <strong>Team Size:</strong> {{ (selectedTeamSize &&
                  selectedTeamSize.name) || 'Not specified' }}
                </p>
                <p>
                  <strong>Scope:</strong> {{ (selectedScope &&
                  selectedScope.name) || 'Not specified' }}
                </p>
                <p>
                  <strong>Constraints:</strong> {{ (project.constraints ||
                  []).join(', ') || 'None' }}
                </p>
              </div>
            </div>

            <div>
              <h3 class="text-lg font-semibold text-gray-300 mb-2">
                Project Goals
              </h3>
              <div class="space-y-2 text-gray-200">
                <p>
                  <strong>Budget:</strong> {{ (selectedBudget &&
                  selectedBudget.name) || 'Not specified' }}
                </p>
                <p>
                  <strong>Target:</strong> {{ (selectedTarget &&
                  selectedTarget.name) || 'Not specified' }}
                </p>
                <p>
                  <strong>Constraints:</strong>
                  @if (selectedConstraints.length === 0) {
                  <span>None specified</span>
                  } @else {
                  <span>{{ selectedConstraints.length }} selected</span>
                  }
                </p>
              </div>
            </div>
          </div>

          <!-- Project Description -->
          <div class="mt-4">
            <h3 class="text-lg font-semibold text-gray-300 mb-2">
              Project Description
            </h3>
            <div class="bg-gray-700/50 p-4 rounded-lg">
              <p class="text-gray-200">
                {{ project.description || 'No description provided' }}
              </p>
            </div>
          </div>
        </div>

        <!-- Visual Identity Summary -->
        <div class="bg-gray-800/50 rounded-xl p-6 mb-8">
          <h2
            class="text-2xl font-bold text-gray-100 mb-4 border-b border-gray-700 pb-2"
          >
            Visual Identity
          </h2>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Logo Preview -->
            <div
              class="bg-gray-700/30 p-4 rounded-lg flex flex-col items-center"
            >
              <h3 class="text-lg font-semibold text-gray-300 mb-4">Logo</h3>
              @if (selectedLogo) {
              <div
                [innerHTML]="getSelectedLogo()?.svg! | safeHtml"
                class="h-32 w-full flex justify-center items-center"
              ></div>
              <p class="text-gray-300 mt-2">
                {{ getSelectedLogo()?.name || 'Custom Logo' }}
              </p>
              } @else {
              <div
                class="w-full h-48 flex items-center justify-center text-gray-500"
              >
                <p>No logo selected</p>
              </div>
              }
            </div>

            <!-- Color Palette Preview -->
            <div class="bg-gray-700/30 p-4 rounded-lg">
              <h3 class="text-lg font-semibold text-gray-300 mb-4">
                Color Palette
              </h3>
              @if (selectedColor && getSelectedColor()) {
              <div class="space-y-3">
                <p class="text-gray-300">{{ getSelectedColor()?.name }}</p>
                <div class="color-preview">
                  <div
                    class="primary-color"
                    [style.backgroundColor]="getSelectedColor()?.colors?.primary || '#ffffff'"
                  ></div>
                  <div
                    class="secondary-color"
                    [style.backgroundColor]="getSelectedColor()?.colors?.secondary || '#cccccc'"
                  ></div>
                  <div
                    class="tertiary-color"
                    [style.backgroundColor]="getSelectedColor()?.colors?.accent || '#999999'"
                  ></div>
                </div>
                <p class="text-gray-300 text-center mt-2">
                  {{ getSelectedColor()?.name || 'Selected Color Palette' }}
                </p>
                <div
                  class="mt-2 p-3 rounded"
                  [style.backgroundColor]="getSelectedColor()?.colors?.background || '#ffffff'"
                >
                  <p
                    [style.color]="getSelectedColor()?.colors?.text || '#000000'"
                    class="mt-2"
                  >
                    Sample Text
                  </p>
                  <div class="flex mt-2">
                    <button
                      class="px-3 py-1 rounded mr-2 text-sm"
                      [style.backgroundColor]="getSelectedColor()?.colors?.primary || '#cccccc'"
                      [style.color]="'white'"
                    >
                      Primary
                    </button>
                    <button
                      class="px-3 py-1 rounded text-sm"
                      [style.backgroundColor]="getSelectedColor()?.colors?.accent || '#999999'"
                      [style.color]="'white'"
                    >
                      Accent
                    </button>
                  </div>
                </div>
              </div>
              } @else {
              <div
                class="w-full h-48 flex items-center justify-center text-gray-500"
              >
                <p>No color palette selected</p>
              </div>
              }
            </div>
          </div>

          <!-- Typography Preview -->
          <div class="mt-6 bg-gray-700/30 p-4 rounded-lg">
            <h3 class="text-lg font-semibold text-gray-300 mb-4">Typography</h3>
            @if (selectedTypography) {
            <div class="space-y-3">
              <p class="text-gray-300">{{ getSelectedTypography()?.name }}</p>
              @if (getSelectedTypography()) {
              <div class="typography-preview">
                <p
                  class="primary-font"
                  [style.fontFamily]="getSelectedTypography()?.primaryFont || 'Arial'"
                >
                  {{ getSelectedTypography()?.primaryFont || 'Primary Font' }}
                </p>
                <p
                  class="secondary-font"
                  [style.fontFamily]="getSelectedTypography()?.secondaryFont || 'sans-serif'"
                >
                  {{ getSelectedTypography()?.secondaryFont || 'Secondary Font'
                  }}
                </p>
              </div>
              }
              <p class="text-gray-300 text-center mt-2">
                {{ getSelectedTypography()?.name || 'Selected Typography' }}
              </p>
              <div class="bg-gray-800/50 p-4 rounded-lg mb-3">
                <p
                  class="text-xl font-bold mb-2"
                  [style.fontFamily]="getSelectedTypography()?.primaryFont"
                >
                  Primary: {{ getSelectedTypography()?.primaryFont }}
                </p>
                <p
                  class="text-base"
                  [style.fontFamily]="getSelectedTypography()?.secondaryFont"
                >
                  Secondary: {{ getSelectedTypography()?.secondaryFont }}
                </p>
              </div>
              <div class="bg-white/10 p-4 rounded-lg">
                <h4
                  class="text-xl font-bold mb-2"
                  [style.fontFamily]="getSelectedTypography()?.primaryFont"
                >
                  Headline Text
                </h4>
                <p
                  class="text-lg font-normal"
                  [style.fontFamily]="getSelectedTypography()?.secondaryFont"
                >
                  This is a sample paragraph showing how your content would look
                  with this typography selection. Good typography improves
                  readability and user experience.
                </p>
              </div>
            </div>
            } @else {
            <div
              class="w-full h-24 flex items-center justify-center text-gray-500"
            >
              <p>No typography selected</p>
            </div>
            }
          </div>
        </div>

        <!-- Privacy Policy and Terms -->
        <div class="bg-gray-800/50 rounded-xl p-6 mb-8">
          <h2
            class="text-2xl font-bold text-gray-100 mb-4 border-b border-gray-700 pb-2"
          >
            Terms & Privacy
          </h2>

          <div class="flex items-start space-x-2 mb-4">
            <div class="flex-shrink-0 pt-0.5">
              <input
                type="checkbox"
                id="privacy-policy"
                class="w-4 h-4 accent-primary"
                [(ngModel)]="privacyPolicyAccepted"
              />
            </div>
            <label for="privacy-policy" class="text-sm text-gray-300">
              I agree to the
              <a href="#" class="text-primary hover:underline"
                >Terms of Service</a
              >
              and
              <a href="#" class="text-primary hover:underline">Privacy Policy</a
              >. I understand that my project data will be stored and processed
              according to these terms.
            </label>
          </div>

          <div class="flex items-start space-x-2">
            <div class="flex-shrink-0 pt-0.5">
              <input
                type="checkbox"
                id="marketing-consent"
                class="w-4 h-4 accent-primary"
                [(ngModel)]="marketingConsentAccepted"
              />
            </div>
            <label for="marketing-consent" class="text-sm text-gray-300">
              I agree to receive marketing communications about product updates,
              improvements, and events. You can unsubscribe at any time.
            </label>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex justify-between mt-6">
          <div>
            <button (click)="showLogoSelectionStep()" class="outer-button">
              <i class="pi pi-arrow-left mr-2"></i> Back
            </button>
          </div>

          <div>
            <button
              class="inner-button"
              [disabled]="!privacyPolicyAccepted"
              (click)="finalizeProjectCreation()"
            >
              <i class="pi pi-check mr-2"></i> Create Project
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>
  } }
</div>
