<!-- Mobile Drawer Backdrop -->
@if (isMobileDrawerOpen()) {
<div
  class="fixed inset-0 bg-black/60 backdrop-blur-sm z-40"
  (click)="toggleMobileDrawer()"
></div>
}

<!-- Top Navigation Bar -->
<nav
  class="fixed top-0 left-0 right-0 z-50 glass border-b border-white/10 px-3 py-3 lg:px-6 transition-all duration-300"
>
  <div class="flex items-center justify-between">
    <!-- Left Section with Logo and Mobile Menu Button -->
    <div class="flex items-center">
      <!-- Logo -->
      <div class="flex-shrink-0 flex items-center">
        <a
          routerLink="/"
          class="text-2xl font-bold hover:text-primary transition duration-300 flex items-center gap-2"
        >
          <img
            src="/assets/icons/logo_white.png"
            alt="Lexi"
            class="sm:w-[120px] w-[50px] h-auto"
          />
          <app-beta-badge></app-beta-badge>
        </a>
      </div>
    </div>

    <!-- Right section -->
    <div class="flex items-center gap-4">
      @if (user()) {
      <!-- Quota Display - Desktop only -->
      <div class="hidden md:block">
        <app-quota-display
          [quotaInfo]="quotaInfo() ?? null"
          [quotaDisplay]="quotaDisplay() ?? null"
          [isBeta]="isBeta()"
          [betaRestrictions]="betaRestrictions() ?? null"
          [isLoading]="isQuotaLoading()"
        ></app-quota-display>
      </div>

      <!-- User Menu -->
      <div class="relative">
        <button
          (click)="toggleDropdown()"
          class="flex items-center gap-2 p-1 rounded-full hover:bg-white/10 transition-all duration-200"
        >
          <img
            [src]="user()!.photoURL"
            alt="Avatar"
            class="w-8 h-8 md:w-10 md:h-10 rounded-full border-2 border-white/20"
          />
        </button>

        <!-- User Dropdown -->
        @if (isDropdownOpen()) {
        <div
          class="absolute right-0 mt-2 w-56 bg-bg-dark border border-white/10 rounded-xl shadow-xl z-50 py-2"
        >
          <div class="px-4 py-3 border-b border-white/10">
            <p class="text-white font-medium truncate">
              {{ user()!.displayName }}
            </p>
            <p class="text-gray-400 text-sm truncate">{{ user()!.email }}</p>
          </div>

          <a
            routerLink="/console/profile"
            (click)="navigateTo('/console/profile')"
            class="flex items-center gap-3 px-4 py-3 text-white hover:bg-white/5 transition-all duration-200"
          >
            <i class="pi pi-user text-primary"></i>
            <span>Profile</span>
          </a>

          <a
            routerLink="/console/projects"
            (click)="navigateTo('/console/projects')"
            class="flex items-center gap-3 px-4 py-3 text-white hover:bg-white/5 transition-all duration-200"
          >
            <i class="pi pi-folder text-accent"></i>
            <span>All Projects</span>
          </a>

          <a
            routerLink="/settings"
            (click)="navigateTo('/settings')"
            class="flex items-center gap-3 px-4 py-3 text-white hover:bg-white/5 transition-all duration-200"
          >
            <i class="pi pi-cog text-secondary"></i>
            <span>Settings</span>
          </a>

          <hr class="border-white/10 my-2" />

          <button
            (click)="logout()"
            class="w-full flex items-center gap-3 px-4 py-3 text-red-400 hover:bg-red-500/10 transition-all duration-200"
          >
            <i class="pi pi-sign-out"></i>
            <span>Logout</span>
          </button>
        </div>
        }
      </div>
      } @else {
      
      }
    </div>
  </div>
</nav>

<!-- Main Content -->
<div class="pt-16 min-h-screen pb-10">
  <router-outlet></router-outlet>
</div>
